<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>JS this | Lam</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.1.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.2.3/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">JS this</h1><a id="logo" href="/.">Lam</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">JS this</h1><div class="post-meta">Jun 28, 2016<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-disqus-identifier="2016/06/28/JS-this/" href="/2016/06/28/JS-this/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p>在Java中，this指向的是当前对象，比如在Bar类中有一个foo方法，那么在foo方法中输出this时，它的值一定是Bar类的实例。</p>
<p>但是在JS中，由于函数作用域是在方法调用时才定义的，因此this的值只有在调用时才能确定，也就是一般情况下谁调用这个方法，那this就指向谁。</p>
<p><strong>函数上下文是当该函数被调用时定义的，而非定义函数时就去定义上下文。</strong></p>
<p>JS的方法有如下几种调用方式：</p>
<ol>
<li>函数式调用</li>
<li>方法式调用</li>
<li>构造方法式调用</li>
<li>apply、call、bind</li>
</ol>
<h3 id="一-函数式调用"><a href="#一-函数式调用" class="headerlink" title="一. 函数式调用"></a>一. 函数式调用</h3><p>JS中使用function定义一个函数，最常见的就是下面这种：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printThis</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line">printThis();</span><br></pre></td></tr></table></figure>
<p>在这个例子中，定义了一个函数printSth并调用它，该函数中的this指向的就是一个全局变量（根据执行环境的不同而不同），在浏览器中就指向<code>window</code>。</p>
<p>再看下面这个例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  printThis: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> func = obj.printThis;</span><br><span class="line">func();</span><br></pre></td></tr></table></figure>
<p>在这个例子中，this仍然指向的是<code>window</code>（浏览器中），可能会有人说this应该是obj，其实不对，，在这个例子中，func在被调用时所处的上下文其实就是window，那么this的值就指向的是window了。</p>
<h3 id="二-方法式调用"><a href="#二-方法式调用" class="headerlink" title="二. 方法式调用"></a>二. 方法式调用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  printThis: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);  <span class="comment">// this === obj 输出：true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.printThis();</span><br></pre></td></tr></table></figure>
<p>在这个例子中，this又指向什么呢？</p>
<p>它指向的正是obj对象。printThis是被obj调用的，因此this指向了obj。</p>
<p>这里还有另外一个例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'window'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'object'</span>,</span><br><span class="line">  printName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.printName();  <span class="comment">// 输出：object，指向obj</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> func = obj.printName;</span><br><span class="line">func();           <span class="comment">// 输出：window，指向window</span></span><br></pre></td></tr></table></figure>
<p>对于方法式调用，它的上下文会被设置到函数被调用的那个对象上。</p>
<p>对于上面这个例子，printName()的上下文会被设置为obj，而func()的上下文会被设置为window，因此分别找到对应的name值，结果就显示为object和widnow。</p>
<p><strong>对于嵌套的函数，它的this指向的是最右边的那个元素</strong>，还是相当于找到它的调用者。</p>
<p>比如<code>foo.bar.func()</code>，那么在func中的this指向的就是bar。</p>
<h3 id="三-构造方法式调用"><a href="#三-构造方法式调用" class="headerlink" title="三. 构造方法式调用"></a>三. 构造方法式调用</h3><p>构造方法通常以大写字母开头，使用构造方法创建对象时使用<code>new</code>关键字。</p>
<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.printThis = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> foo = <span class="keyword">new</span> Foo();</span><br><span class="line">foo.printThis();    <span class="comment">// 输出：Foo &#123;&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>以这种方式调用构造函数经历了以下4个步骤：<br>1.创建一个新对象<br>2.将构造函数的作用域赋给新对象（因此this就指向了这个对象）<br>3.执行构造函数中的代码（为这个新对象添加属性）<br>4.返回新对象</p>
<p>构造函数通常不返回return关键字，通常初始化新对象，当构造函数的函数体执行完毕时，会显式返回。在这种情况下，构造函数调用表达式的计算结果就是这个新对象的值；如果构造函数显式地使用return语句返回一个对象，那么调用表达式的值就是该对象；如果构造函数使用return语句但没有指定返回值，或者返回一个原始值，那么将忽略返回值。</p>
</blockquote>
<h3 id="四-apply、call调用"><a href="#四-apply、call调用" class="headerlink" title="四. apply、call调用"></a>四. apply、call调用</h3><p>两个方法的作用是相同的，它们的第一个参数相同，是为函数提供的上下文。都可以接收多个参数，除第一个参数外，</p>
<p>对于call方法：接收一个参数列表用以传入函数<br>对于apply方法：接收一个参数数组用以传入函数</p>
<p>即，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">func.call(context, args0, args1, args2...);</span><br><span class="line">func.apply(context, [args0, args1, args2...]);</span><br></pre></td></tr></table></figure>
<p>对于上面的这个例子</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'window'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'object'</span>,</span><br><span class="line">  printName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.printName();  <span class="comment">// 输出：object，指向obj</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> func = obj.printName;</span><br><span class="line"><span class="comment">// func();           // 输出：window，指向window</span></span><br><span class="line">func.call(obj);     <span class="comment">// 与使用func.apply(obj)结果相同，输出：object</span></span><br></pre></td></tr></table></figure>
<p>再看下面这个例子</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.x += a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;x: <span class="number">0</span>&#125;;</span><br><span class="line">add.call(obj, <span class="number">1</span>, <span class="number">2</span>);    <span class="comment">// 与add.apply(obj, [1, 2])结果相同，均为3</span></span><br></pre></td></tr></table></figure>
<p><strong>如果是非严格模式且第一个参数为null或者undefined，那么会被替换为全局对象，浏览器中是window，其它环境则是global。如果是严格模式，则输出null或undefined。</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>; &#125;</span><br><span class="line">fun.call(<span class="literal">null</span>);</span><br><span class="line">fun.apply(<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">var</span> f = fun.bind(<span class="literal">null</span>);</span><br><span class="line">f();</span><br><span class="line"><span class="comment">// 输出Window</span></span><br><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>; &#125;</span><br><span class="line">fun() === <span class="literal">undefined</span></span><br><span class="line">fun.call(<span class="number">2</span>) === <span class="number">2</span></span><br><span class="line">fun.apply(<span class="literal">null</span>) === <span class="literal">null</span></span><br><span class="line">fun.call(<span class="literal">undefined</span>) === <span class="literal">undefined</span></span><br><span class="line">fun.bind(<span class="literal">true</span>)() === <span class="literal">true</span></span><br><span class="line"><span class="comment">// 结果均为true</span></span><br></pre></td></tr></table></figure>
<p>还有一个方法，<strong><code>bind()</code></strong>，该方法也可以修改函数的上下文，不过一旦修改，无论如何调用该函数，它的上下文都是相同的，即this指向的是同样的值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">  x: <span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> obj2 = &#123;</span><br><span class="line">  x: <span class="number">2</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> func = show.bind(obj1);</span><br><span class="line">func();     <span class="comment">// 输出：1</span></span><br><span class="line">func.call(obj2);     <span class="comment">// 输出：1</span></span><br><span class="line">func.call(<span class="built_in">window</span>);   <span class="comment">// 输出：1</span></span><br><span class="line">func.bind(obj2)();   <span class="comment">// 输出：1</span></span><br></pre></td></tr></table></figure>
<p>在这个例子中，可以看到，一旦将obj1作为上下文绑定到show函数上（将绑定后的函数赋值给func），无论之后如何修改func函数的上下文，它输出的永远是1，也就是它的上下文没有任何修改，一直是obj1。</p>
<hr>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ol>
<li><strong>函数上下文是当该函数被调用时定义的。</strong></li>
<li><strong>如果是非严格模式且第一个参数为null或者undefined，那么会被替换为全局对象，浏览器中是window，其它环境则是global。如果是严格模式，则输出null或undefined。</strong></li>
</ol>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://lam0114.github.io/2016/06/28/JS-this/" data-id="ciqbzkohl0004xkxuzfdlajpo" class="article-share-link">分享到</a><div class="tags"><a href="/tags/JS/">JS</a></div><div class="post-nav"><a href="/2016/06/29/CSS-Hacks/" class="pre">CSS Hacks</a><a href="/2016/05/25/Angular初始化组件加载/" class="next">Angular初始化组件加载</a></div><div id="disqus_thread"><script>var disqus_shortname = 'lam0114';
var disqus_identifier = '2016/06/28/JS-this/';
var disqus_title = 'JS this';
var disqus_url = 'http://lam0114.github.io/2016/06/28/JS-this/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//lam0114.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://lam0114.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/css/" style="font-size: 15px;">css</a> <a href="/tags/angular/" style="font-size: 15px;">angular</a> <a href="/tags/JS/" style="font-size: 15px;">JS</a> <a href="/tags/jsfiddle/" style="font-size: 15px;">jsfiddle</a> <a href="/tags/react/" style="font-size: 15px;">react</a> <a href="/tags/redux/" style="font-size: 15px;">redux</a> <a href="/tags/js/" style="font-size: 15px;">js</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/07/07/点击ul中的li，显示其索引/">点击ul中的li，显示其索引</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/01/容器组件和状态组件/">容器组件和状态组件</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/29/CSS-Hacks/">CSS Hacks</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/28/JS-this/">JS this</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/25/Angular初始化组件加载/">Angular初始化组件加载</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/20/Shadowsocks搭建核心步骤/">Shadowsocks搭建教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/18/JSFiddle-Angular-Uncaught-Error/">JSFiddle Angular Uncaught Error</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/17/Git常用命令/">Git常用命令</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/17/使用Hexo和Github搭建博客/">使用Hexo和Github搭建博客</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/07/React-Controlled-Component/">React Controlled Component</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><script type="text/javascript" src="//lam0114.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Lam.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>